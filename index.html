<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Khảo sát Nhanh trí Sáng mắt</title>
  <!-- viewport setup -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- lab.js library and experiment code -->
  <!-- lab.js library code -->
  <script src="lib/lab.js" data-labjs-script="library"></script>
  <script src="lib/lab.fallback.js" data-labjs-script="fallback"></script>
  <link rel="stylesheet" href="lib/lab.css">
  <!-- study code and styles -->
  <script src="script.js" defer="true"></script>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <!-- If you'd rather have a container with a fixed width
       and variable height, try removing the fullscreen class below -->
  <div class="container fullscreen" data-labjs-section="main">
    <main class="content-vertical-center content-horizontal-center">
      <div>
        <h2>Đang tải khảo sát...</h2>
        <p>Vui lòng chờ trong giây lát.</p>
      </div>
    </main>
  </div>
</body>
<script>
  // Sau khi khảo sát kết thúc (Lab.js v2)
  study.run().then(() => {
    // Lấy toàn bộ dữ liệu khảo sát
    const jsonData = study.options.datastore.exportJson();

    // Gửi về Google Apps Script endpoint
    fetch('https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec', {
      method: 'POST',
      body: jsonData,
      headers: {
        'Content-Type': 'application/json',
      }
    })
    .then(response => response.text())
    .then(result => {
      alert("Dữ liệu đã được gửi thành công!");
      console.log("Server response:", result);
    })
    .catch(error => {
      alert("Lỗi khi gửi dữ liệu!");
      console.error("Lỗi:", error);
    });
  });
</script>

</html>
